<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Datenstruktur | R Kurs Unterlagen</title>
  <meta name="description" content="<p>Dies sind R Kurs Unterlagen für Lehre in verschiedenen studentischen
Veranstaltungen.</p>" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Datenstruktur | R Kurs Unterlagen" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://amd-lab.github.io/R-Kurs-Unterlagen/index.html" />
  
  <meta property="og:description" content="<p>Dies sind R Kurs Unterlagen für Lehre in verschiedenen studentischen
Veranstaltungen.</p>" />
  <meta name="github-repo" content="AMD-Lab/R-Kurs-Unterlagen" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Datenstruktur | R Kurs Unterlagen" />
  
  <meta name="twitter:description" content="<p>Dies sind R Kurs Unterlagen für Lehre in verschiedenen studentischen
Veranstaltungen.</p>" />
  



<meta name="date" content="2021-10-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="einführung.html"/>
<link rel="next" href="deskreptive-statistik.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Über dieses Buch</a></li>
<li class="chapter" data-level="2" data-path="einführung.html"><a href="einführung.html"><i class="fa fa-check"></i><b>2</b> Einführung</a></li>
<li class="chapter" data-level="3" data-path="datenstruktur.html"><a href="datenstruktur.html"><i class="fa fa-check"></i><b>3</b> Datenstruktur</a>
<ul>
<li class="chapter" data-level="3.1" data-path="datenstruktur.html"><a href="datenstruktur.html#rmarkdown"><i class="fa fa-check"></i><b>3.1</b> RMarkdown</a></li>
<li class="chapter" data-level="3.2" data-path="datenstruktur.html"><a href="datenstruktur.html#hilfe"><i class="fa fa-check"></i><b>3.2</b> Hilfe</a></li>
<li class="chapter" data-level="3.3" data-path="datenstruktur.html"><a href="datenstruktur.html#werte-vektoren"><i class="fa fa-check"></i><b>3.3</b> Werte &amp; Vektoren</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="datenstruktur.html"><a href="datenstruktur.html#coercion-umwandlung-von-typen"><i class="fa fa-check"></i><b>3.3.1</b> Coercion (Umwandlung von Typen)</a></li>
<li class="chapter" data-level="3.3.2" data-path="datenstruktur.html"><a href="datenstruktur.html#aufruf-einzelner-elemente-per-index"><i class="fa fa-check"></i><b>3.3.2</b> Aufruf einzelner Elemente per Index:</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="datenstruktur.html"><a href="datenstruktur.html#der-workspace"><i class="fa fa-check"></i><b>3.4</b> Der Workspace</a></li>
<li class="chapter" data-level="3.5" data-path="datenstruktur.html"><a href="datenstruktur.html#einfache-berechnungen"><i class="fa fa-check"></i><b>3.5</b> Einfache Berechnungen</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="datenstruktur.html"><a href="datenstruktur.html#rechnen-mit-values"><i class="fa fa-check"></i><b>3.5.1</b> Rechnen mit Values</a></li>
<li class="chapter" data-level="3.5.2" data-path="datenstruktur.html"><a href="datenstruktur.html#rechnen-mit-vektoren"><i class="fa fa-check"></i><b>3.5.2</b> Rechnen mit Vektoren</a></li>
<li class="chapter" data-level="3.5.3" data-path="datenstruktur.html"><a href="datenstruktur.html#übersicht-berechnungsfunktionen"><i class="fa fa-check"></i><b>3.5.3</b> Übersicht Berechnungsfunktionen</a></li>
<li class="chapter" data-level="3.5.4" data-path="datenstruktur.html"><a href="datenstruktur.html#beispiel-einer-z-standardisierung-eines-vektors-mit-3-einträgen"><i class="fa fa-check"></i><b>3.5.4</b> Beispiel einer z-Standardisierung eines Vektors mit 3 Einträgen</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="datenstruktur.html"><a href="datenstruktur.html#matrizen"><i class="fa fa-check"></i><b>3.6</b> Matrizen</a></li>
<li class="chapter" data-level="3.7" data-path="datenstruktur.html"><a href="datenstruktur.html#tidy-daten"><i class="fa fa-check"></i><b>3.7</b> tidy Daten</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="datenstruktur.html"><a href="datenstruktur.html#tidyverse"><i class="fa fa-check"></i><b>3.7.1</b> tidyverse</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="datenstruktur.html"><a href="datenstruktur.html#data.frames-df-und-tibbles-tib"><i class="fa fa-check"></i><b>3.8</b> data.frames (df) und tibbles (tib)</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="datenstruktur.html"><a href="datenstruktur.html#faktoren"><i class="fa fa-check"></i><b>3.8.1</b> Faktoren</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="datenstruktur.html"><a href="datenstruktur.html#einlesen-und-speichern-von-daten"><i class="fa fa-check"></i><b>3.9</b> Einlesen und Speichern von Daten</a></li>
<li class="chapter" data-level="3.10" data-path="datenstruktur.html"><a href="datenstruktur.html#datensätze-dat-anschauen"><i class="fa fa-check"></i><b>3.10</b> Datensätze (dat) anschauen</a></li>
<li class="chapter" data-level="3.11" data-path="datenstruktur.html"><a href="datenstruktur.html#einführung-in-dplyr-und-tidyverse"><i class="fa fa-check"></i><b>3.11</b> Einführung in Dplyr und tidyverse</a></li>
<li class="chapter" data-level="3.12" data-path="datenstruktur.html"><a href="datenstruktur.html#dplyr-die-wichtigsten-befehle"><i class="fa fa-check"></i><b>3.12</b> Dplyr: Die wichtigsten Befehle</a></li>
<li class="chapter" data-level="3.13" data-path="datenstruktur.html"><a href="datenstruktur.html#übung-1"><i class="fa fa-check"></i><b>3.13</b> Übung 1</a></li>
<li class="chapter" data-level="3.14" data-path="datenstruktur.html"><a href="datenstruktur.html#dplyr-der-piping-operator"><i class="fa fa-check"></i><b>3.14</b> Dplyr: Der Piping Operator</a></li>
<li class="chapter" data-level="3.15" data-path="datenstruktur.html"><a href="datenstruktur.html#beispiel"><i class="fa fa-check"></i><b>3.15</b> Beispiel</a></li>
<li class="chapter" data-level="3.16" data-path="datenstruktur.html"><a href="datenstruktur.html#übung-2"><i class="fa fa-check"></i><b>3.16</b> Übung 2</a></li>
<li class="chapter" data-level="3.17" data-path="datenstruktur.html"><a href="datenstruktur.html#dplyr-neue-variablen-mit-mutate-berechnen"><i class="fa fa-check"></i><b>3.17</b> Dplyr : Neue Variablen mit <code>mutate()</code> berechnen</a></li>
<li class="chapter" data-level="3.18" data-path="datenstruktur.html"><a href="datenstruktur.html#beispiel-1"><i class="fa fa-check"></i><b>3.18</b> Beispiel</a></li>
<li class="chapter" data-level="3.19" data-path="datenstruktur.html"><a href="datenstruktur.html#aufgabe-bis-zum-nächsten-mal"><i class="fa fa-check"></i><b>3.19</b> Aufgabe bis zum nächsten Mal</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="deskreptive-statistik.html"><a href="deskreptive-statistik.html"><i class="fa fa-check"></i><b>4</b> Deskreptive Statistik</a></li>
<li class="chapter" data-level="5" data-path="graphiken.html"><a href="graphiken.html"><i class="fa fa-check"></i><b>5</b> Graphiken</a></li>
<li class="chapter" data-level="6" data-path="tipps.html"><a href="tipps.html"><i class="fa fa-check"></i><b>6</b> Tipps</a>
<ul>
<li class="chapter" data-level="6.1" data-path="tipps.html"><a href="tipps.html#chapters"><i class="fa fa-check"></i><b>6.1</b> chapters</a></li>
<li class="chapter" data-level="6.2" data-path="tipps.html"><a href="tipps.html#a-section"><i class="fa fa-check"></i><b>6.2</b> A section</a>
<ul>
<li class="chapter" data-level="" data-path="tipps.html"><a href="tipps.html#an-unnumbered-section"><i class="fa fa-check"></i>An unnumbered section</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="tipps.html"><a href="tipps.html#cross-referenc-chapters-and-sub-chapters"><i class="fa fa-check"></i><b>6.3</b> cross-referenc: Chapters and sub-chapters</a></li>
<li class="chapter" data-level="6.4" data-path="tipps.html"><a href="tipps.html#captioned-figures-and-tables"><i class="fa fa-check"></i><b>6.4</b> Captioned figures and tables</a></li>
<li class="chapter" data-level="6.5" data-path="tipps.html"><a href="tipps.html#footnotes"><i class="fa fa-check"></i><b>6.5</b> Footnotes</a></li>
<li class="chapter" data-level="6.6" data-path="tipps.html"><a href="tipps.html#citations"><i class="fa fa-check"></i><b>6.6</b> Citations</a></li>
<li class="chapter" data-level="6.7" data-path="tipps.html"><a href="tipps.html#equations"><i class="fa fa-check"></i><b>6.7</b> Equations</a></li>
<li class="chapter" data-level="6.8" data-path="tipps.html"><a href="tipps.html#theorems-and-proofs"><i class="fa fa-check"></i><b>6.8</b> Theorems and proofs</a></li>
<li class="chapter" data-level="6.9" data-path="tipps.html"><a href="tipps.html#callout-blocks"><i class="fa fa-check"></i><b>6.9</b> Callout blocks</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R Kurs Unterlagen</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="datenstruktur" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Datenstruktur</h1>
<table>
<colgroup>
<col width="24%" />
<col width="75%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Thema</th>
<th align="center">Inhalte</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">RMarkdown</td>
<td align="center"><em>Titel, Chunks, knitten</em></td>
</tr>
<tr class="even">
<td align="center">Hilfe</td>
<td align="center"><em>help-Fenster, ?, #was passiert hier</em></td>
</tr>
<tr class="odd">
<td align="center">Werte, Vektoren
&amp; Listen</td>
<td align="center"><em>chr, num, log, c(), list(), typeof(), coercion,
Abruf von Elementen, list(list())</em></td>
</tr>
<tr class="even">
<td align="center">Workspace</td>
<td align="center"><em>rm(), Besen</em></td>
</tr>
<tr class="odd">
<td align="center">Berechnungen</td>
<td align="center"><em>mit Values, Vektoren, Funktionen, z-Standardisierung</em></td>
</tr>
<tr class="even">
<td align="center">Matrizen</td>
<td align="center"><em>matrix(), Indizierung</em></td>
</tr>
<tr class="odd">
<td align="center">tidy Daten</td>
<td align="center"><em>Zeilen: Beobachtungen, Spalten: Variablen</em></td>
</tr>
<tr class="even">
<td align="center">tidyverse</td>
<td align="center"><em>Installation und library (package)</em></td>
</tr>
<tr class="odd">
<td align="center">data.frame &amp;
tibble</td>
<td align="center"><em>Unterschiede, as.data.frame(), as_tibble(), $, [],
Zugriff auf Elemente, Reihennamen, Faktoren</em></td>
</tr>
<tr class="even">
<td align="center">Daten laden
&amp; speichern</td>
<td align="center"><em>Import per klick, read./_, sep=,
dec=, .xlsx, .svs, write_csv()</em></td>
</tr>
<tr class="odd">
<td align="center">Daten anschauen</td>
<td align="center"><em>View(), head(), str(), count()</em></td>
</tr>
</tbody>
</table>
<div id="rmarkdown" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> RMarkdown</h2>
<p>Das R Markdown Skript ist ein besonderes Dateiformat für R Skripte. Es enthält Fließtext und eingebetteten R Code:</p>
<p><img src="_bookdown_files/_main_files/figure-html/RMarkmitNum.png" style="width:65.0%" /></p>
<p><code>Knittet</code> man dies Skript mit dem Wollknäul Button (5.) in der oberen Leiste, integriert es den ausgeführten Code mit dem Fließtext und druckt ein übersichtliches Dokument (html, pdf, txt oder doc). Das ist praktisch um z.B. Auswertungsergebnisse zu präsentieren.</p>
<ol style="list-style-type: decimal">
<li>Im Header werden Titel und Dokumententyp für das Ausgabe-Dokument festgelegt</li>
<li>Die Code Blöcke (<code>Chunks</code>) sind mit je drei rückwärts gestellten Hochkommata (<code>Backticks</code>) am Anfang und Ende des Chunks eingerahmt. Werden sie vom R Markdown Skript als solche erkannt, wird auch die Hintergrundfarbe automatisch abgeändert. Im ersten chunk sollten <code>globale Chunk Optionen festgelegt</code>, alle notwendigen <code>Packages geladen</code> und die <code>Daten eingelesen</code> werden.</li>
<li>Den Fließtext kann man mit Überschriften (<code>#</code>) und Unterüberschriften (<code>##</code>) strukturieren, im Code kennzeichnet <code>#</code>
Kommentare</li>
<li>Zu Beginn eines Chunks muss man innerhalb einer geschwungenen Klammer spezifizieren(```{…}):</li>
</ol>
<ul>
<li><p>Es ist möglich Code von anderen Programmiersprachen (z.B. Python oder TeX) einzubetten, standard ist <code>r</code></p></li>
<li><p>(optional) Nach einem Leerzeichen: Einzigartiger Chunk-Name</p></li>
<li><p>(optional) Nach einem Komma: Befehle, um die Ausgabe des Chunks in das neue Dokument zu steuern:</p>
<ul>
<li><code>include = FALSE</code> Weder Code noch Ergebnis erscheinen</li>
<li><code>echo = FALSE</code> Nur das Code-Ergebnis erscheint</li>
<li><code>message = FALSE</code> Nachrichten zum Code erscheinen nicht</li>
<li><code>warning = FALSE</code> Warnungenzum Code erscheinen nicht</li>
<li><code>fig.cap = "..."</code> Hiermit lassen sich Grafiken beschriften</li>
</ul></li>
</ul>
</div>
<div id="hilfe" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Hilfe</h2>
<p>Sie merken, dass die Befehle und Funktionen zum Teil sehr spezifisch und Sie sich kaum alles behalten können. Am wichtigsten ist die Reihenfolge und Vollständigkeit der Zeichen: vergessen Sie ein Komma, ein Backtick oder eine Klammer zu, dann kann R den Code schon nicht interpretieren. Zum Glück erkennt R Studio das oft und weist einen darauf während des
Codens mit einem <code>roten x</code> neben der Zeilennummer hin. Andernfalls dürfen Sie versuchen, die Fehlermeldung beim Ausführen zu verstehen.</p>
<p>Wenn Sie den Namen einer Funktion oder eines Packages nicht direkt erinnern, können Sie den Anfang des Namens im <code>Chunk</code> oder in der <code>Console</code> eingeben, RStudio bietet einem nach einem kurzen Moment eine Liste möglicher Optionen an, aus der Sie wählen können. Haben Sie eine Funktion gewählt, können sie die <code>Tab</code>-Taste drücken und es werden die verschiedenen Funktionsargumente angezeigt, um die Funktion zu spezifizieren, was oft sehr hilfreich ist. Möchten Sie wissen, was eine
Funktion macht oder in welcher Reihenfolge die Funktionsargumente eingegeben werden, können Sie <code>?FUN</code> in die <code>Console</code> eintippen, wobei FUN Platzhalter für den Funktionsnamen ist. Alternativ können Sie im <code>Help</code>-tab unten rechts suchen. Die Dokumentation ist oft sehr ausführlich. Die Möglichkeit einschlägige Suchmaschinen im Internet zu verwenden ist fast zu trivial, um sie hier aufzuführen, oft werden Sie dabei auf <code>StackOverflow</code> weitergeleitet. Auf Englisch gestellte Fragen
oder Probleme führen zu besseren Treffern. Noch trivialer ist es, im Skript des Kurses oder im eigenen Code nachzuschauen. Falls Sie gründlich nachlesen möchten, gibt es auch ganze Bücher, die einem eine Einführung in R geben: z.B. <code>R Cookbook</code> oder <code>R for Data Science</code>.</p>
</div>
<div id="werte-vektoren" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Werte &amp; Vektoren</h2>
<p>Datenformate in R sind von einfach zu komplex: <code>Value</code>, Vektor, <code>matrix</code>, (<code>array</code>), <code>data.frame</code>,<code>tibble</code> und <code>list</code>. Die kleinste Objekteinheit in R ist ein <code>Value</code>. Es gibt unterschiedliche Typen von <code>Values</code>:</p>
<ol style="list-style-type: decimal">
<li>Text, bzw. Charakter (<code>chr</code>), manchmal auch String genannt,</li>
<li>(komplexe Zahlen, <code>cmplx</code>)</li>
<li>Nummer (<code>num</code>), bzw.<code>double</code></li>
<li>(ganze Zahlen, integer <code>int</code> genannt)</li>
<li>logische Werte (<code>logi</code>), manchmal auch Boolean genannt</li>
<li>fehlende Werte (<code>NA</code>), <code>Not Available</code></li>
</ol>
<p>Sie weisen einem Objektnamen einen Wert per <code>&lt;-</code> zu (Shortkey:<code>ALT</code>&amp;<code>-</code>), der Datentyp des <code>Values</code> wird automatisch Rkannt.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="datenstruktur.html#cb1-1" aria-hidden="true" tabindex="-1"></a>var1 <span class="ot">&lt;-</span> <span class="st">&quot;kreativ&quot;</span>   <span class="co"># typ chr</span></span>
<span id="cb1-2"><a href="datenstruktur.html#cb1-2" aria-hidden="true" tabindex="-1"></a>var2 <span class="ot">&lt;-</span> <span class="fl">3.5</span>         <span class="co"># typ num</span></span>
<span id="cb1-3"><a href="datenstruktur.html#cb1-3" aria-hidden="true" tabindex="-1"></a>var3 <span class="ot">&lt;-</span> <span class="cn">TRUE</span>        <span class="co"># typ logi</span></span></code></pre></div>
<p>Mit der Funktion <code>typeof()</code> können sie sich den Datentypen anzeigen lassen.
Vektoren reihen Werten desselben Datentyps auf <code>c(Wert1, Wert2, ...)</code>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="datenstruktur.html#cb2-1" aria-hidden="true" tabindex="-1"></a>vec1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">6</span>, <span class="fl">3.4</span>)    <span class="co"># c() kombiniert die Werte zu einem Vektor, der dem Namen zugewiesen wird</span></span></code></pre></div>
<p>Fassen Sie Werte von verschiedenen Typen zu einem Vektor zussammen, werden beide Werte zum Typen mit der kleineren Typenzahl umgewandelt (<code>coercion</code>).</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="datenstruktur.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">&quot;kreativ&quot;</span>,<span class="fl">3.5</span>)   <span class="co"># ich versuche ein `chr` und eine `num` zu einem Vektor zu kombinieren</span></span></code></pre></div>
<pre><code>## [1] &quot;kreativ&quot; &quot;3.5&quot;</code></pre>
<p>3.5 wird in <code>""</code> ausgegeben, die Nummer wurde zu Text.</p>
<div id="coercion-umwandlung-von-typen" class="section level3" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Coercion (Umwandlung von Typen)</h3>
<p>Sie können den Datentypen auch per Funktion ändern, z.B. <code>as.character()</code>, <code>as.double()</code>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="datenstruktur.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.character</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="cn">TRUE</span>, <span class="st">&quot;abc&quot;</span>, <span class="fl">4.1627</span>))  <span class="co"># Verändert eine Reihe von Werten zum Typ chr</span></span></code></pre></div>
<pre><code>## [1] &quot;1&quot;      &quot;TRUE&quot;   &quot;abc&quot;    &quot;4.1627&quot;</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="datenstruktur.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.double</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="cn">TRUE</span>, <span class="st">&quot;abc&quot;</span>, <span class="fl">4.1627</span>))    <span class="co"># Verändert die Werte zum Typ double, geht es nicht, erscheinen NAs</span></span></code></pre></div>
<pre><code>## Warning: NAs durch Umwandlung erzeugt</code></pre>
<pre><code>## [1] 2.0000     NA     NA 4.1627</code></pre>
<p><code>Coercion</code> gibt es auch in Matrizen, Arrays (Mehrdimensionale Matrizen) und in Spaltenvektoren von Datensätzen (data.frames und tibbles). Nur Listen können verschiedene Datentypen und Elemente enthalten <code>list(Element1, Element2, ...)</code>. Das geht soweit, dass Listen selbst Listen enthalten können.</p>
</div>
<div id="aufruf-einzelner-elemente-per-index" class="section level3" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> Aufruf einzelner Elemente per Index:</h3>
<p>Um auf Elemente zuzugreifen, können Sie deren Indexnummer verwenden:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="datenstruktur.html#cb10-1" aria-hidden="true" tabindex="-1"></a>vec_4 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">7</span>)   <span class="co">#Definition des Vektors</span></span>
<span id="cb10-2"><a href="datenstruktur.html#cb10-2" aria-hidden="true" tabindex="-1"></a>vec_4[<span class="dv">2</span>]              <span class="co">#Abruf des zweiten Elements des Vektors</span></span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<p>Das geht sogar in verschachtelten Listen:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="datenstruktur.html#cb12-1" aria-hidden="true" tabindex="-1"></a>mylist <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">list</span>(<span class="dv">1</span>,<span class="st">&quot;a&quot;</span>),<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)) <span class="co"># Definiert eine Liste aus Liste &amp; Vector, die je aus 2 Elementen bestehen </span></span>
<span id="cb12-2"><a href="datenstruktur.html#cb12-2" aria-hidden="true" tabindex="-1"></a>mylist[[<span class="dv">1</span>]][<span class="dv">2</span>]                     <span class="co"># Ruft Element 1 der äußeren Liste: (1,&quot;a&quot;), und davon Element 2 ab: &quot;a&quot;</span></span></code></pre></div>
<pre><code>## [[1]]
## [1] &quot;a&quot;</code></pre>
<p>Ich habe jetzt mehrere Variablen (Values, Vektoren, Listen) definiert, sie sind in meinem RStudio im <code>Environment</code>-tab oben rechts aufgetaucht.</p>
</div>
</div>
<div id="der-workspace" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Der Workspace</h2>
<p>Rechts oben im Fenster ist das <code>Environment</code>-tab. Hier sieht man alle im <code>globale Workspace</code> definierten Objekte (Datenstrukturen: Werte, Vektoren, Matrizen, Arrays, Listen, <code>data.frames</code>, <code>tibbles</code>; und Funktionen) aufgelistet:</p>
<p><img src="img/Workspace.png" style="width:65.0%" /></p>
<p>Per Doppelklick können Sie die Objekte jeweils einzeln oben links im extra Fenster (<code>Datenansicht-tab</code> ) anschauen. <code>rm(Objektname)</code> ist die Funktion zum Entfernen einzelner Objekte aus dem <code>globalen Workspace</code>. Das <code>Besensymbol</code> im <code>Environment</code>-tab oben rechts fegt den <code>globalen Workspace</code> leer. Es ist zu beachten, dass R Markdown beim <code>knitten</code> nicht auf den <code>globalen Workspace</code> zugreift, sondern einen eigenen Workspace aus dem Code in den <code>Chunks</code> erstellt. Beim Ausführen
einzelner <code>Chunks</code> per Markieren und <code>STRG/CTRL</code>&amp;<code>Enter</code> oder <code>grüner Pfeil rechts</code> wird jedoch auf den <code>globalen Workspace</code>
zugegriffen. Beim Schließen von RStudio werden Sie gefragt, ob Sie den <code>globalen Workspace</code> in die <code>.RData</code> als img speichern lassen, dann stehen die Objekte in der nächsten Sitzung wieder zur Verfügung, solange Sie dieselbe Projektdatei öffnen. Offene Skipte und offene <code>Datenansicht</code>-tabs werden beim Schließen ebenfalls mit der Projektdatei assoziiert. Geladene Packages gehen leider verloren, diese müssen Sie jedes Mal beim Starten von RStudio neu laden: <code>library(Packagename)</code>. Deshalb ist es Konvention am Anfang jedes Skriptes erstmal die Packages zu laden. Haben Sie Objekte im Workspace gespeichert, können Sie deren
Namen verwenden, um sich auf diese zu beziehen und z.B. weitere Berechnungen vorzunehmen.</p>
</div>
<div id="einfache-berechnungen" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Einfache Berechnungen</h2>
<div id="rechnen-mit-values" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Rechnen mit Values</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="datenstruktur.html#cb14-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">5</span>       <span class="co"># definiert den Wert der Variable x</span></span>
<span id="cb14-2"><a href="datenstruktur.html#cb14-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">5</span>       <span class="co"># definiert den Wert der Variable x</span></span>
<span id="cb14-3"><a href="datenstruktur.html#cb14-3" aria-hidden="true" tabindex="-1"></a>x <span class="sc">+</span> y        <span class="co"># Summe von x und y</span></span>
<span id="cb14-4"><a href="datenstruktur.html#cb14-4" aria-hidden="true" tabindex="-1"></a>x<span class="sc">*</span>y          <span class="co"># Produkt von x und y </span></span>
<span id="cb14-5"><a href="datenstruktur.html#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(x)      <span class="co"># Wurzel aus x</span></span>
<span id="cb14-6"><a href="datenstruktur.html#cb14-6" aria-hidden="true" tabindex="-1"></a>x<span class="sc">**</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)     <span class="co"># x hoch 0.5</span></span></code></pre></div>
<p>Möchten Sie das Ergebnis speichern, müssen Sie dem berechneten Wert einen Namen zuweisen:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="datenstruktur.html#cb15-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> x <span class="sc">+</span> y  <span class="co"># weist dem Namen z das Ergebnis dieser Gleichung zu, &quot;z&quot; erscheint im Workspace</span></span></code></pre></div>
</div>
<div id="rechnen-mit-vektoren" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Rechnen mit Vektoren</h3>
<p>Operationen können häufig vektorisiert, d.h. auf alle Objekte einens Vektors angewendet werden:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="datenstruktur.html#cb16-1" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> vec_4 <span class="sc">*</span> <span class="dv">5</span> <span class="co"># multipliziert alle Elemente des Vekors mit 5 und speichert das Ergebnis unter dem Namen e</span></span></code></pre></div>
<p>Es gibt eine ganze Reihe vorgefertigter Funktionen, um mit Vektoren zu rechnen:</p>
</div>
<div id="übersicht-berechnungsfunktionen" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Übersicht Berechnungsfunktionen</h3>
<p>Folgende Funktionen können Sie auf <code>num</code>-Vektoren und Matrizen anwenden, je nach Funktion auch auf <code>chr</code> Vektoren oder Datensätze, wobei diese sich dann meist nur auf die Einträge in der oberen Ebene, z.B. auf die Anzahl der Spalten und nicht auf die Spalteneinträge beziehen.</p>
<table style="width:99%;">
<colgroup>
<col width="25%" />
<col width="23%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Funktion</th>
<th align="center">Bedeutung</th>
<th align="center">Funktion</th>
<th align="center">Bedeutung</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>min(x)</strong></td>
<td align="center">Minimum</td>
<td align="center"><strong>mean(x)</strong></td>
<td align="center">Mittelwert</td>
</tr>
<tr class="even">
<td align="center"><strong>max(x)</strong></td>
<td align="center">Maximum</td>
<td align="center"><strong>median(x)</strong></td>
<td align="center">Median</td>
</tr>
<tr class="odd">
<td align="center"><strong>range(x)</strong></td>
<td align="center">Range</td>
<td align="center"><strong>var(x)</strong></td>
<td align="center">Varianz</td>
</tr>
<tr class="even">
<td align="center"><strong>sort(x)</strong></td>
<td align="center">sortiert x</td>
<td align="center"><strong>sd(x)</strong></td>
<td align="center">Sta
ndardabweichung</td>
</tr>
<tr class="odd">
<td align="center"><strong>sum(x)</strong></td>
<td align="center">Summe aller
Elemente</td>
<td align="center"><strong>quantile(x)</strong></td>
<td align="center">Quantile von x</td>
</tr>
<tr class="even">
<td align="center"><strong>cor(x,y)</strong></td>
<td align="center">Korrelation
von x und y</td>
<td align="center"><strong>length()</strong></td>
<td align="center">Länge von x</td>
</tr>
</tbody>
</table>
</div>
<div id="beispiel-einer-z-standardisierung-eines-vektors-mit-3-einträgen" class="section level3" number="3.5.4">
<h3><span class="header-section-number">3.5.4</span> Beispiel einer z-Standardisierung eines Vektors mit 3 Einträgen</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="datenstruktur.html#cb17-1" aria-hidden="true" tabindex="-1"></a>geschwister <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">4</span>,<span class="dv">12</span>)                       <span class="co"># def. der Variable</span></span>
<span id="cb17-2"><a href="datenstruktur.html#cb17-2" aria-hidden="true" tabindex="-1"></a>mw_geschw <span class="ot">&lt;-</span> <span class="fu">mean</span>(geschwister)                 <span class="co"># MW</span></span>
<span id="cb17-3"><a href="datenstruktur.html#cb17-3" aria-hidden="true" tabindex="-1"></a>mw_geschw                                      </span></code></pre></div>
<pre><code>## [1] 8</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="datenstruktur.html#cb19-1" aria-hidden="true" tabindex="-1"></a>sd_geschw <span class="ot">&lt;-</span> <span class="fu">sd</span>(geschwister)                   <span class="co"># SD</span></span>
<span id="cb19-2"><a href="datenstruktur.html#cb19-2" aria-hidden="true" tabindex="-1"></a>sd_geschw</span></code></pre></div>
<pre><code>## [1] 4</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="datenstruktur.html#cb21-1" aria-hidden="true" tabindex="-1"></a>z_geschw <span class="ot">&lt;-</span> (geschwister<span class="sc">-</span>mw_geschw)<span class="sc">/</span>sd_geschw  <span class="co"># z-Standardisierung des Vektors</span></span>
<span id="cb21-2"><a href="datenstruktur.html#cb21-2" aria-hidden="true" tabindex="-1"></a>z_geschw</span></code></pre></div>
<pre><code>## [1]  0 -1  1</code></pre>
</div>
</div>
<div id="matrizen" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Matrizen</h2>
<p>Matrizen sind 2D Datenstrukturen, sie bestehenaus Vektoren <u>gleicher</u> Länge und enthalten <u>einen</u> Datentyp. Mit dem
Befehl <code>matrix()</code> können sie erstellt werden:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="datenstruktur.html#cb23-1" aria-hidden="true" tabindex="-1"></a>mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NaN</span>, <span class="at">nrow=</span><span class="dv">4</span>, <span class="at">ncol=</span><span class="dv">4</span>) <span class="co"># Eine Matrix mat mit 4 Reihen, 4 Spalten und leeren Einträgen wird erstellt</span></span>
<span id="cb23-2"><a href="datenstruktur.html#cb23-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="co"># NaN (Not a Number) ist zwar ein double, aber rechnen kann man damit nicht</span></span>
<span id="cb23-3"><a href="datenstruktur.html#cb23-3" aria-hidden="true" tabindex="-1"></a>mat</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]  NaN  NaN  NaN  NaN
## [2,]  NaN  NaN  NaN  NaN
## [3,]  NaN  NaN  NaN  NaN
## [4,]  NaN  NaN  NaN  NaN</code></pre>
<p>Ich habe eine 4x4 Matrix erstellt, die mit NaNs gefüllt ist. Hätte ich diverse Datentypen zugeordnet, wären diese zum niedrigeren <code>coerced</code> worden. Matrizen können mit <code>matrixname[Zeile,Spalte]</code> manipuliert werden. Beispiel:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="datenstruktur.html#cb25-1" aria-hidden="true" tabindex="-1"></a>mat[,<span class="dv">1</span>] <span class="ot">&lt;-</span> vec_4 <span class="co"># Weil Spalte 1. von mat und vec_4 dieselbe Länge haben, kann ich Spalte 1 neu zuweisen. </span></span>
<span id="cb25-2"><a href="datenstruktur.html#cb25-2" aria-hidden="true" tabindex="-1"></a>mat              <span class="co"># Dadurch, dass der Eintrag für die Zeilennummer leer ist, beziehe ich mich auf alle Zeilen.</span></span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    1  NaN  NaN  NaN
## [2,]    3  NaN  NaN  NaN
## [3,]    3  NaN  NaN  NaN
## [4,]    7  NaN  NaN  NaN</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="datenstruktur.html#cb27-1" aria-hidden="true" tabindex="-1"></a>mat[,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">8</span>  <span class="co"># Wird einem Bereich ein einzelner Wert zugeordnet, wird dieser vervielfacht (wie oben bei NaN)</span></span>
<span id="cb27-2"><a href="datenstruktur.html#cb27-2" aria-hidden="true" tabindex="-1"></a>mat</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    1    8  NaN  NaN
## [2,]    3    8  NaN  NaN
## [3,]    3    8  NaN  NaN
## [4,]    7    8  NaN  NaN</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="datenstruktur.html#cb29-1" aria-hidden="true" tabindex="-1"></a>mat[,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="cn">TRUE</span>) <span class="co"># Wird eine ganzzahlige Teilmenge (2 von 4) zugewiesen, wird diese vervielfacht</span></span>
<span id="cb29-2"><a href="datenstruktur.html#cb29-2" aria-hidden="true" tabindex="-1"></a>mat                       <span class="co"># Anm.: das nennt sich recyclen,</span></span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    1    8    0  NaN
## [2,]    3    8    1  NaN
## [3,]    3    8    0  NaN
## [4,]    7    8    1  NaN</code></pre>
<p>Coercion: TRUE wurde zu 1 und FALSE wurde zu 0. Wenn man nun eine
bestimmte Spalte oder Zeile sehen möchte, kann man dies über die
Indizierung tun, hierbei kann man sich beliebig austoben.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="datenstruktur.html#cb31-1" aria-hidden="true" tabindex="-1"></a>mat[,<span class="dv">1</span>]      <span class="co"># Ich möchte nur die erste Spalte über alle Zeilen ausgeben</span></span></code></pre></div>
<pre><code>## [1] 1 3 3 7</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="datenstruktur.html#cb33-1" aria-hidden="true" tabindex="-1"></a>mat[<span class="dv">1</span>,<span class="dv">1</span>]     <span class="co"># Nur den ersten Wert der ersten Spalte</span></span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>Hier wird es turbulent:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="datenstruktur.html#cb35-1" aria-hidden="true" tabindex="-1"></a>mat[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),] <span class="co"># Nur Zeile 1 und 3 von allen Spalten</span></span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    1    8    0  NaN
## [2,]    3    8    0  NaN</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="datenstruktur.html#cb37-1" aria-hidden="true" tabindex="-1"></a>mat[<span class="sc">-</span><span class="dv">1</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]  <span class="co"># Nicht Zeile 1 und Spalten 2-4</span></span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    8    1  NaN
## [2,]    8    0  NaN
## [3,]    8    1  NaN</code></pre>
<p>Da ich jetzt Bereiche der Matrix auswählen kann, lohnt es sich Berechnungen vorzunehmen</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="datenstruktur.html#cb39-1" aria-hidden="true" tabindex="-1"></a>(mat[,<span class="dv">2</span>]<span class="sc">+</span>mat[,<span class="dv">1</span>])<span class="sc">*</span>mat[,<span class="dv">3</span>]             <span class="co"># Spalte 2 minus Spalte 1 und dann mal Spalte 3</span></span></code></pre></div>
<pre><code>## [1]  0 11  0 15</code></pre>
<p>Es sind immer noch nicht angegebene Nummernwerte in der Matrix, solange ich mich beim Berechnen auf Bereiche der Matrix beschränke, die vergebene numerische Werte haben, gibt es kein Problem, ansonsten schon:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="datenstruktur.html#cb41-1" aria-hidden="true" tabindex="-1"></a>mat[<span class="dv">1</span>,]                   <span class="co"># Zeile 1</span></span></code></pre></div>
<pre><code>## [1]   1   8   0 NaN</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="datenstruktur.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(mat[<span class="dv">1</span>,])         <span class="co"># Summe über Zeile 1 mit NaN</span></span></code></pre></div>
<pre><code>## [1] NaN</code></pre>
<p>Die Summe kann nicht berechnet werden. Zum Auslassen der NaNs wird das Funktionsargument <code>na.rm=TRUE</code> verwendet:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="datenstruktur.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(mat[<span class="dv">1</span>,], <span class="at">na.rm=</span><span class="cn">TRUE</span>)  <span class="co"># Summe über Zeile 1 ohne NaN</span></span></code></pre></div>
<pre><code>## [1] 9</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="datenstruktur.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(mat, <span class="at">na.rm=</span><span class="cn">TRUE</span>)     <span class="co"># MW der Matrix ohne NaN</span></span></code></pre></div>
<pre><code>## [1] 4</code></pre>
<p>Nun, da wir mit dem Rechnen in Matrizen vertraut sind möchte ich die
letzte Spalte mit Einträgen füllen:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="datenstruktur.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(mat)             <span class="co"># gebe den Typ der Einträge der Matrix aus</span></span></code></pre></div>
<pre><code>## [1] &quot;double&quot;</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="datenstruktur.html#cb51-1" aria-hidden="true" tabindex="-1"></a>mat_sav <span class="ot">&lt;-</span> mat          <span class="co"># in weiser Voraussicht speichere ich die bisherige Matrix unter anderem Namen</span></span>
<span id="cb51-2"><a href="datenstruktur.html#cb51-2" aria-hidden="true" tabindex="-1"></a>mat[,<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;coercion&quot;</span>,<span class="st">&quot;kann&quot;</span>,<span class="st">&quot;nervig&quot;</span>,<span class="st">&quot;sein&quot;</span>)  <span class="co"># weise Spalte 4 einen Vektor mit chr Einträgen zu</span></span>
<span id="cb51-3"><a href="datenstruktur.html#cb51-3" aria-hidden="true" tabindex="-1"></a>mat </span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]      
## [1,] &quot;1&quot;  &quot;8&quot;  &quot;0&quot;  &quot;coercion&quot;
## [2,] &quot;3&quot;  &quot;8&quot;  &quot;1&quot;  &quot;kann&quot;    
## [3,] &quot;3&quot;  &quot;8&quot;  &quot;0&quot;  &quot;nervig&quot;  
## [4,] &quot;7&quot;  &quot;8&quot;  &quot;1&quot;  &quot;sein&quot;</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="datenstruktur.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(mat)</span></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<p>Konnte ich eben noch den Mittelwert einer Spalte bilden, so geht das jetzt nicht mehr, da alle Einträge der Matrix zu <code>chr</code> coerced wurden. In einem typischen Datensatz sind aber Variablen verschiedener Typen (<code>num</code> und <code>chr</code>) enthalten. Dieses Problem ließe sich mit Listen lösen, welche aber unübersichtlich sind. Datensätze bestehen manchmal aus unüberschaubar vielen Einträgen und deshalb müssen sie übersichtlich strukturiert sein.</p>
</div>
<div id="tidy-daten" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> tidy Daten</h2>
<p>Es gibt eine Konvention dafür, wie man Datensätze, die mehreren Beobachtungseinheiten (Fällen) verschiedene Parameter (Variablen) zuordnet. Wichtig für die eigene strukturierte Arbeit ist in erster Linie Konsistenz, z.B. dass Sie bei Variablennamen aus mehreren Wörtern immer den Unterstrich als Trennzeichen verwenden. Es hat sich als überlegen für die Auswertung von Daten herausgestellt, Fälle in Zeilen und Variablen in Spalten einzuordnen, dieses Prinzip dürfte Einigen
schon von SPSS bekannt sein.</p>
<table>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">Variable1</th>
<th align="center">Variable2</th>
<th align="center">Was ist ‘tidy’ data?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Fall1</td>
<td align="center">Wert11</td>
<td align="center">Wert12</td>
<td align="center"><u>Eine Zeile</u> pro <u>Beobachtung</u></td>
</tr>
<tr class="even">
<td align="center">Fall2</td>
<td align="center">Wert21</td>
<td align="center">Wert22</td>
<td align="center"><u>Eine Spalte</u> pro <u>Variable</u></td>
</tr>
<tr class="odd">
<td align="center">Fall3</td>
<td align="center">Wert31</td>
<td align="center">Wert32</td>
<td align="center">Eine Tabelle pro Untersuchung</td>
</tr>
<tr class="even">
<td align="center">Fall4</td>
<td align="center">Wert41</td>
<td align="center">Wert42</td>
<td align="center">eindeutige Namen</td>
</tr>
<tr class="odd">
<td align="center">Fall5</td>
<td align="center">Wert51</td>
<td align="center">Wert52</td>
<td align="center">Konsistenz</td>
</tr>
<tr class="even">
<td align="center">Fall6</td>
<td align="center">Wert61</td>
<td align="center">Wert62</td>
<td align="center">…</td>
</tr>
</tbody>
</table>
<p>Es gibt noch weitere Regeln für konsistentes und ordentliches Arbeiten in R und mit Datensätzen im Allgemeinen, z.B. dass man keine Farbcodierungen verwenden sollte. Vorerst genügt es, wenn Sie sich an die Basics hier halten. Diese Art Daten zu strukturieren lässt sich im <code>data.frame</code> und noch besser im <code>tibble</code> umsetzen: Beides sind Tabellen mit Spaltenvektoren, die jeweils verschiedene Datentypen enthalten können. Deswegen stellen beide das bevorzugte und für unsere Zwecke wichtigste Datenformat dar.</p>
<div id="tidyverse" class="section level3" number="3.7.1">
<h3><span class="header-section-number">3.7.1</span> tidyverse</h3>
<p>Bevor wir uns dem schönsten Datenformat, den <code>tibble</code>s widmen, müssen wir das entsprechende Package einmalig in der <code>Console</code> installieren. Ich habe den Code auskommentiert, weil das Package bei mir bereits installiert ist:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="datenstruktur.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&quot;tidyverse&quot;)  # R kennt den Namen noch nicht, deswegen &quot;&quot;</span></span></code></pre></div>
<p>Das Package <code>tidyverse</code> enthält eine Reihe nützlicher Packages, die eine saubere Datenverarbeitung zum Ziel haben. Packages müssen bei jeder Sitzung neu aktiviert bzw. angehängt werden. Für uns relevante Packages im tidyverse sind <code>tibble</code>, <code>readr</code>, <code>stringr</code>, <code>dplyr</code>, <code>purr</code> und <code>ggplot2</code>.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="datenstruktur.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)   <span class="co"># Bitte an den Anfang eines Skriptes, um beim Starten der R Session anzuhängen (attach).</span></span></code></pre></div>
</div>
</div>
<div id="data.frames-df-und-tibbles-tib" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> data.frames (df) und tibbles (tib)</h2>
<p>Es gibt mehr Gemeinsamkeiten als Unterschiede zwischen beiden Datenformaten. Beides sind Tabellen mit Spaltenvektoren (Variablen), die je verschiedene Datentypen enthalten können. Hier zunächst die Übersicht über die Funktionen zum Managen des Datensatzes:</p>
<table>
<thead>
<tr class="header">
<th align="center">Funktion zum</th>
<th align="center"><code>data.frame()</code></th>
<th align="center"><code>tibble()</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Datenformat konvertieren</td>
<td align="center"><code>as.data.frame()</code></td>
<td align="center"><code>as_tibble()</code></td>
</tr>
<tr class="even">
<td align="center">Definieren</td>
<td align="center">data.frame(var1,…)</td>
<td align="center">tibble(var1,…)</td>
</tr>
<tr class="odd">
<td align="center">Aufrufen des Datensatzes</td>
<td align="center">df</td>
<td align="center">tib</td>
</tr>
<tr class="even">
<td align="center">Auswählen einer Variable</td>
<td align="center">df$var</td>
<td align="center">tib$var</td>
</tr>
<tr class="odd">
<td align="center">Auswählen eines Bereiches</td>
<td align="center">df[rowIdx,colIdx]</td>
<td align="center">tib[rowIdx,colIdx]</td>
</tr>
<tr class="even">
<td align="center">Definieren neuer Variablen</td>
<td align="center">df$var_neu &lt;- c(…)</td>
<td align="center">tib$var_neu &lt;- c(…)</td>
</tr>
<tr class="odd">
<td align="center">Reihennamen vergeben</td>
<td align="center">row.names(df) &lt;-c(“name1,”…)</td>
<td align="center">relocate(tib,var)</td>
</tr>
</tbody>
</table>
<p>Sie können die beiden Datensatz-Formate einfach in das jeweils andere konvertieren. Die Definition geht per Formel <code>data.frame()</code> und die Aneinanderreihung der Spaltenvektoren. Es bietet sich an, dabei direkt Namen für die Spaltenvektoren zu vergeben. Für tibbles geht das analog mit der Formel<code>tibble()</code></p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="datenstruktur.html#cb57-1" aria-hidden="true" tabindex="-1"></a>test_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&quot;text&quot;</span><span class="ot">=</span>mat[,<span class="dv">4</span>] ,         <span class="co"># Komma zwischen Spaltenvektoren</span></span>
<span id="cb57-2"><a href="datenstruktur.html#cb57-2" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;ist_Verb&quot;</span><span class="ot">=</span>mat_sav[,<span class="dv">3</span>])  <span class="co"># verwende die Spaltenvektoren aus den vorherigen Matrizen und weise Namen zu</span></span>
<span id="cb57-3"><a href="datenstruktur.html#cb57-3" aria-hidden="true" tabindex="-1"></a>test_df</span></code></pre></div>
<pre><code>##       text ist_Verb
## 1 coercion        0
## 2     kann        1
## 3   nervig        0
## 4     sein        1</code></pre>
<p>In Bezug auf weitere Funktionen des Packages <code>tidyverse</code> sind tibbles ein wenig praktischer. Große tibbles werden übersichtlicher angezeigt (nur die ersten 10 Zeilen) wenn man sie aufruft.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="datenstruktur.html#cb59-1" aria-hidden="true" tabindex="-1"></a>test_tib <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(test_df)  </span>
<span id="cb59-2"><a href="datenstruktur.html#cb59-2" aria-hidden="true" tabindex="-1"></a>test_tib</span></code></pre></div>
<pre><code>## # A tibble: 4 x 2
##   text     ist_Verb
##   &lt;chr&gt;       &lt;dbl&gt;
## 1 coercion        0
## 2 kann            1
## 3 nervig          0
## 4 sein            1</code></pre>
<p>Einzelne Spalten können ganz einfach aufgerufen werden, in dem man den $-Operator benutzt. Schreibt man diesen direkt hinter den Namen des Datensatzes, klappt automatisch eine Liste mit allen Spalten auf:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="datenstruktur.html#cb61-1" aria-hidden="true" tabindex="-1"></a>test_tib<span class="sc">$</span>text   <span class="co"># Mit dem $-Operator können einzelnen Spalten direkt per Name adressiert werden.</span></span></code></pre></div>
<pre><code>## [1] &quot;coercion&quot; &quot;kann&quot;     &quot;nervig&quot;   &quot;sein&quot;</code></pre>
<p>Es ist auch möglich, mehrere Zeilen und/oder Spalten auszugeben, dies funktioniert wie bei Matrizen per Indexnummer:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="datenstruktur.html#cb63-1" aria-hidden="true" tabindex="-1"></a>test_tib[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>,<span class="dv">1</span>] <span class="co"># Die Zeilen 2 bis 4 werden aus Spalte 1 ausgebenen</span></span></code></pre></div>
<pre><code>## # A tibble: 3 x 1
##   text  
##   &lt;chr&gt; 
## 1 kann  
## 2 nervig
## 3 sein</code></pre>
<p>Die Adressierung einzelner Spalten und Zeilen ermöglicht dann zum Beispiel die Berechnung von Kennwerten nur für einzelnen Spalten. Z.B. kann man die Kosten für Konzertkarten im Jahr 2022 aufsummieren lassen:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="datenstruktur.html#cb65-1" aria-hidden="true" tabindex="-1"></a>tickets_2022 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">&quot;Artist&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;Ed Sheeran&quot;</span>, <span class="st">&quot;Billy Ellish&quot;</span>, <span class="st">&quot;The Weeknd&quot;</span>, <span class="st">&quot;Dua Lipa&quot;</span>, <span class="st">&quot;Imagine Dragons&quot;</span>),</span>
<span id="cb65-2"><a href="datenstruktur.html#cb65-2" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;Kosten&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="fl">79.32</span>, <span class="dv">282</span>, <span class="dv">116</span>, <span class="dv">136</span>, <span class="fl">68.71</span> ))</span>
<span id="cb65-3"><a href="datenstruktur.html#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(tickets_2022<span class="sc">$</span>Kosten)</span></code></pre></div>
<pre><code>## [1] 682.03</code></pre>
<p>Der $-Operator wird für fast alle höheren Datentypen verwendet, um auf diese Zuzugreifen. Dies gilt zum Beispiel auch für die meisten Outputs von Funktionen (t-Test, Anova, SEMs) und Listen, es müssen aber wie im tibble Namen für die Listeneinträge vergeben sein:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="datenstruktur.html#cb67-1" aria-hidden="true" tabindex="-1"></a>liist_of_things <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">tibbi =</span> test_tib,         <span class="co"># erstellt eine Liste aus diversen Objekten in meinem Workspace</span></span>
<span id="cb67-2"><a href="datenstruktur.html#cb67-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">ticki =</span> tickets_2022,     <span class="co"># den Namen der Listeneinträge werden </span></span>
<span id="cb67-3"><a href="datenstruktur.html#cb67-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">geschwi =</span> geschwister,    <span class="co"># die Objekte aus dem Workspace zugeordnet</span></span>
<span id="cb67-4"><a href="datenstruktur.html#cb67-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">vari =</span> var1)   </span>
<span id="cb67-5"><a href="datenstruktur.html#cb67-5" aria-hidden="true" tabindex="-1"></a>liist_of_things<span class="sc">$</span>geschwi                           <span class="co"># per $-Operator und Name in der Liste wird der Eintrag gewählt</span></span></code></pre></div>
<pre><code>## [1]  8  4 12</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="datenstruktur.html#cb69-1" aria-hidden="true" tabindex="-1"></a>liist_of_things<span class="sc">$</span>ticki <span class="co"># Und so die Variable ticki (hier das ticket_2022 tibble)</span></span></code></pre></div>
<pre><code>## # A tibble: 5 x 2
##   Artist          Kosten
##   &lt;chr&gt;            &lt;dbl&gt;
## 1 Ed Sheeran        79.3
## 2 Billy Ellish     282  
## 3 The Weeknd       116  
## 4 Dua Lipa         136  
## 5 Imagine Dragons   68.7</code></pre>
<p>Theoretisch könnte ich auch noch<code>\$Artist</code> hinzufügen, dann würde mir nur die erste Spalte des tibbles ausgegeben. Mir fällt auf, ich habe den Namen eine Künstlerin in tickets_2022 falsch geschrieben:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="datenstruktur.html#cb71-1" aria-hidden="true" tabindex="-1"></a>tickets_2022<span class="sc">$</span>Artist[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Billy Eilish&quot;</span> <span class="co"># $-Operator und Indexing lassen sich kombinieren</span></span></code></pre></div>
<p>Sie können also nicht nur Elemente aus Datensätzen abrufen, sondern diese mit dem <code>&lt;-</code> neu zuweisen. Man kann das $ auch verwenden um neue Spalten in die Datensätze einzufügen:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="datenstruktur.html#cb72-1" aria-hidden="true" tabindex="-1"></a>tickets_2022<span class="sc">$</span>Priorität <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">1</span>)  <span class="co"># definiert eine neue Spalte im Datensatz</span></span>
<span id="cb72-2"><a href="datenstruktur.html#cb72-2" aria-hidden="true" tabindex="-1"></a>tickets_2022<span class="sc">$</span>Prioritaet <span class="ot">&lt;-</span> tickets_2022<span class="sc">$</span>Priorität <span class="co"># besser ae statt ä in Variablennamen </span></span>
<span id="cb72-3"><a href="datenstruktur.html#cb72-3" aria-hidden="true" tabindex="-1"></a>tickets_2022              <span class="co"># nun gibt es eine Spalte zu viel</span></span></code></pre></div>
<pre><code>## # A tibble: 5 x 4
##   Artist          Kosten Priorität Prioritaet
##   &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
## 1 Ed Sheeran        79.3         2          2
## 2 Billy Eilish     282           4          4
## 3 The Weeknd       116           3          3
## 4 Dua Lipa         136           5          5
## 5 Imagine Dragons   68.7         1          1</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="datenstruktur.html#cb74-1" aria-hidden="true" tabindex="-1"></a>tickets_2022<span class="sc">$</span>Priorität <span class="ot">&lt;-</span> <span class="cn">NULL</span>   <span class="co"># entfernt eine Spalte, vorsichtig hierbei(!)</span></span></code></pre></div>
<p>Ein weitere Unterschied zwischen tibbles und data.frames ist, dass tibbles keine Reihennamen kennen. Das vereinfacht das Format. Möchten Sie trotzdem gerne Reihennamen vergeben, dann müssen Sie sich mit einer neuen Variable(z.B. Reihenname) behelfen, die Sie mit <code>relocate(tib,var)</code> an den Anfang des Datensatzes stellen.</p>
<div id="faktoren" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Faktoren</h3>
<p>Vektoren, die kategoriale Einträge enthalten können Sie mit <code>factor()</code> als Faktor zuweisen:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="datenstruktur.html#cb75-1" aria-hidden="true" tabindex="-1"></a>Gegut_vec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;m&quot;</span>, <span class="st">&quot;f&quot;</span>, <span class="st">&quot;d&quot;</span>, <span class="st">&quot;f&quot;</span>, <span class="st">&quot;f&quot;</span>, <span class="st">&quot;m&quot;</span>, <span class="st">&quot;f&quot;</span>, <span class="st">&quot;f&quot;</span>, <span class="st">&quot;f&quot;</span>, <span class="st">&quot;m&quot;</span>,<span class="st">&quot;m&quot;</span>, <span class="st">&quot;f&quot;</span>, <span class="st">&quot;m&quot;</span>, <span class="st">&quot;f&quot;</span>, <span class="st">&quot;f&quot;</span>, <span class="st">&quot;m&quot;</span>, <span class="st">&quot;f&quot;</span>, <span class="st">&quot;f&quot;</span>, <span class="st">&quot;f&quot;</span>, <span class="st">&quot;m&quot;</span>) </span>
<span id="cb75-2"><a href="datenstruktur.html#cb75-2" aria-hidden="true" tabindex="-1"></a>Gegut_fac <span class="ot">&lt;-</span> <span class="fu">factor</span>(Gegut_vec)                 <span class="co"># macht Faktor aus kategorialem Vector und speichert unter Namen</span></span>
<span id="cb75-3"><a href="datenstruktur.html#cb75-3" aria-hidden="true" tabindex="-1"></a>Gegut_fac                                      <span class="co"># ruft den Faktor auf:</span></span></code></pre></div>
<pre><code>##  [1] m f d f f m f f f m m f m f f m f f f m
## Levels: d f m</code></pre>
<p>Es werden die einzelnen Ausprägungen und die möglichen Ausprägungen als Levels ausgegeben. <code>levels()</code> gibt nur die möglichen Ausrägungen eines Faktors aus. Faktoren eignen sich oft besser als Vectoren zum Plotten und Rechnen, deswegen ist es nützlich kategoriale Spaltenvektoren im Datensatz zu Faktoren zu machen. Jetzt, wo Sie mit dem Management von Datensätzen vertraut sind wollen wir vorhandene Datensätze einlesen:</p>
</div>
</div>
<div id="einlesen-und-speichern-von-daten" class="section level2" number="3.9">
<h2><span class="header-section-number">3.9</span> Einlesen und Speichern von Daten</h2>
<p>Daten können in R Studio auf unterschiedliche Weise eingelesen werden. Ich habe dieses Bild zur Abwechslung für Ihre Augen erstellt.</p>
<p><img src="_bookdown_files/_main_files/figure-html/png.png" style="width:50.0%" /></p>
<p>Es gibt frei verfügbare Datensätze in Packages, z.B. einen Datensatz zu Pinguinen: palmerpenguins.</p>
<p>Horst AM, Hill AP, Gorman KB (2020). palmerpenguins: Palmer Archipelago (Antarctica) penguin data. R package version 0.1.0.
<a href="https://allisonhorst.github.io/palmerpenguins/" class="uri">https://allisonhorst.github.io/palmerpenguins/</a></p>
<p>Nach einmaliger Installation des Packages (<code>install.packages("palmerpenguins"</code>) muss es geladen werden:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="datenstruktur.html#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(palmerpenguins) <span class="co"># jedes Mal beim Durchlaufen des Skripts. Ohne &quot;&quot;</span></span>
<span id="cb77-2"><a href="datenstruktur.html#cb77-2" aria-hidden="true" tabindex="-1"></a>pengu <span class="ot">&lt;-</span> penguins       <span class="co"># penguins ist zwar schon ein tibble, aber Namenszuweisung zum Laden in den Workspace</span></span></code></pre></div>
<p>In der Regel werden Sie aber einen selbst erhobenen oder einen aus dem Internet heruntergeladenen Datensatz einlesen wollen. Mein Tipp ist, den Datensatz in das Working Directory zu speichern, dann finden Sie ihn schneller und er ist in der Nähe Ihrer Auswertung, noch eleganter ist es einen Unterordner namens data in den Ordner des Working Directories anzulegen, in den Sie alle Datensätze zu ihrem Projekt speichern können. Im <code>File</code>-tab unten rechts navigieren Sie zu der Datei mit dem Datensatz und dann klicken Sie diese zum Importieren des Datensatzes an (alternativ können Sie im <code>Environment</code>-tab über den Button <code>Import Dataset</code> einen Datensatz zum Importieren auf ihrem Computer suchen). In RStudio erscheint ein Fenster zum Importieren, unten rechts wird der automatisch der dem Dateiformat und unten links angegebenen Optionen entspricht, ggf. werden sogar benötigte Packages geladen. Um einen Datensatz per Code zu importieren sind Dateiformat, die Trennzeichen (<code>sep</code>) und die Dezimalzeichen (<code>dec</code>) besonders relevant. Das Standard-Dateiformat ist <code>.csv</code>, hier sind Kommata Trennzeichen (<code>sep=","</code>) und Punkte kennzeichnen Dezimalstellen (<code>dec="."</code>). Sie können die Funktionen <code>read_cvs()</code> oder <code>read_delim()</code> für dieses Dateiformat verwenden, letztere sollte Trenn- und Dezimalzeichen automatisch erkennen. Hier ist eine Übersicht zu den Einlesefunktionen in base R (also ohne zusätzlich geladene Packages) und im tidiverse Package, der Unterschied ist, dass base R Funktionen die Daten in einen data.frame laden, tidyverse Funktionen in ein tibble:</p>
<table>
<thead>
<tr class="header">
<th align="center">Funktion zum</th>
<th align="center">sep</th>
<th align="center">dec</th>
<th align="center">in base R</th>
<th align="center">im tidverse</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><u>autolesen</u></td>
<td align="center">auto</td>
<td align="center">.</td>
<td align="center"><code>read.delim()</code></td>
<td align="center"><code>read_delim()</code></td>
</tr>
<tr class="even">
<td align="center">autolesen</td>
<td align="center">auto</td>
<td align="center">,</td>
<td align="center"><code>read.delim2()</code></td>
<td align="center"><code>read _delim2()</code></td>
</tr>
<tr class="odd">
<td align="center">lesen von</td>
<td align="center">,</td>
<td align="center">.</td>
<td align="center"><code>read.csv()</code></td>
<td align="center"><code>read_csv()</code></td>
</tr>
<tr class="even">
<td align="center">lesen von</td>
<td align="center">leer</td>
<td align="center">.</td>
<td align="center"><code>read.table()</code></td>
<td align="center"><code>read_table()</code></td>
</tr>
<tr class="odd">
<td align="center"><u>schreiben</u></td>
<td align="center">,</td>
<td align="center">.</td>
<td align="center"><code>write.csv()</code></td>
<td align="center"><code>write_csv()</code></td>
</tr>
</tbody>
</table>
<p>Wichtigstes und oft einziges Funktionsargument ist der vollständige Dateiname, er wird in <code>"</code> angegeben. Falls Sie die Datei in einem Unterordner vom Working Directory gespeichert haben, wird den Name des Unterordners mit einem <code>/</code> dem Dateinamen vorangestellt (z.B.“data/Datensatz1.csv”). Das Einlesen von Daten funktioniert nur, wenn der einzulesende Datensatz per <code>&lt;-</code> einem Namen zugewiesen wird. Beispiel zum Laden eines .csv Datensatzes:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="datenstruktur.html#cb78-1" aria-hidden="true" tabindex="-1"></a>socken <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="st">&quot;data/socken.csv&quot;</span>) <span class="co"># liest meinen socken.csv Datensatz aus dem Unterordner</span></span>
<span id="cb78-2"><a href="datenstruktur.html#cb78-2" aria-hidden="true" tabindex="-1"></a>socken                                  <span class="co"># Daten in ein tibble namens socken</span></span></code></pre></div>
<pre><code>## # A tibble: 2 x 3
##   Stoff Gewicht Bewertung
##   &lt;chr&gt;   &lt;dbl&gt;     &lt;dbl&gt;
## 1 Seide    0.03        10
## 2 Wolle    0.08         9</code></pre>
<p>Excel Dateien werden mit Funktionen <code>read_excel()</code>, <code>read_xls()</code> oder <code>read_xlsx()</code> aus dem Package <code>readxl</code>, SPSS Dateien mit der Funktion <code>read_svs()</code> aus dem Package <code>haven</code> eingelesen. Auch zum Einlesen von SAS, Stata oder anderen Dateiformaten gibt es entsprechende Funktionen. Die Standardfunktion zum Abspeichern von Datensätzen in eine Datei ist <code>write_csv()</code>, bzw. in base R <code>write.csv()</code>, da dieses Dateiformat die beste Kompatibilität mit anderer Software aufweist. Beim Speichern muss
man neben dem Dateinamen und ggf. Dateipfad noch den Namen des Datensatzes als erstes Funktionsargument angeben:</p>
<p>Es gibt noch ein weiteres erwähnenswertes Dateiformat, das von R selbst: <code>.RDS</code>. Die Funktionen <code>saveRDS()</code> und <code>readRDS()</code> bieten die beste Funktionalität in R.</p>
</div>
<div id="datensätze-dat-anschauen" class="section level2" number="3.10">
<h2><span class="header-section-number">3.10</span> Datensätze (dat) anschauen</h2>
<p>Um sich die geladenen Daten ganz anzuschauen kann man sie im <code>Workspace</code> anklicken, oder deren Namen an die Funktion <code>view(dat)</code> übergeben. <code>head(dat)</code> zeigt einem den Kopf des Datensatzes an, genau genommen die ersten 6 Zeilen:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="datenstruktur.html#cb80-1" aria-hidden="true" tabindex="-1"></a>long_tib <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Person_Id=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>), </span>
<span id="cb80-2"><a href="datenstruktur.html#cb80-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Gender=</span>Gegut_fac, </span>
<span id="cb80-3"><a href="datenstruktur.html#cb80-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Eigenschaft=</span>var1)  <span class="co"># definiert ein 20 x 3 tibble, </span></span>
<span id="cb80-4"><a href="datenstruktur.html#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(long_tib)                        <span class="co"># zeigt die ersten 6 Zeilen jeder Variable an</span></span></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##   Person_Id Gender Eigenschaft
##       &lt;int&gt; &lt;fct&gt;  &lt;chr&gt;      
## 1         1 m      kreativ    
## 2         2 f      kreativ    
## 3         3 d      kreativ    
## 4         4 f      kreativ    
## 5         5 f      kreativ    
## 6         6 m      kreativ</code></pre>
<p>Einen Überlick über die Datenstruktur, inklusive Factor-<code>levels</code> erhält man mit der Funktion <code>str(dat)</code>:</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="datenstruktur.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(long_tib)      <span class="co"># zeigt die Struktur der Daten</span></span></code></pre></div>
<pre><code>## tibble [20 x 3] (S3: tbl_df/tbl/data.frame)
##  $ Person_Id  : int [1:20] 1 2 3 4 5 6 7 8 9 10 ...
##  $ Gender     : Factor w/ 3 levels &quot;d&quot;,&quot;f&quot;,&quot;m&quot;: 3 2 1 2 2 3 2 2 2 3 ...
##  $ Eigenschaft: chr [1:20] &quot;kreativ&quot; &quot;kreativ&quot; &quot;kreativ&quot; &quot;kreativ&quot; ...</code></pre>
<p>Zeile 1 gibt Auskunft über Größe und die Klasse des Objektes, tibbles sind eine Art data.frame. In den weiteren Zeilen werden die Datentypen ggf. Faktorlevel und die ersten Werte angezeigt. Mit der Funktion <code>count(dat,var)</code> lassen sich die Häufigkeiten der Levels eines Faktors ausgeben:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="datenstruktur.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">count</span>(long_tib, Gender)     <span class="co"># zählt im long_tib die Levels des Faktors Gender</span></span></code></pre></div>
<pre><code>## # A tibble: 3 x 2
##   Gender     n
##   &lt;fct&gt;  &lt;int&gt;
## 1 d          1
## 2 f         12
## 3 m          7</code></pre>

</div>
<div id="einführung-in-dplyr-und-tidyverse" class="section level2" number="3.11">
<h2><span class="header-section-number">3.11</span> Einführung in Dplyr und tidyverse</h2>
<p>Dplyr ist Teil des tidyverse Packages und ermöglicht es, Daten sehr einfach zu manipulieren und in eine Form zu bringen, um diese dann zu analysieren. Um das zu tun greifen wir auf den Star Wars Datensatz zurück, den das dplyr Package mitliefert:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="datenstruktur.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lest die Daten bitte ein, der Datensatz heisst &quot;starwars.RDS&quot; und befindet sich in eurem Projektordner, diesmal benutzen wir den readRDS() Befehl.</span></span>
<span id="cb86-2"><a href="datenstruktur.html#cb86-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-3"><a href="datenstruktur.html#cb86-3" aria-hidden="true" tabindex="-1"></a>starwars <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;starwars.RDS&quot;</span>)</span></code></pre></div>
<p>Der Datensatz enthält Informationen über unsere Star Wars Helden, ähnlich dem Datensatz, den wir uns in der letzten Sitzung ausgedacht haben:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="datenstruktur.html#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(starwars,<span class="dv">5</span>) <span class="co"># Wir lassen uns erstmal die ersten 5 Zeilen des Datensatzes ausgeben</span></span></code></pre></div>
<pre><code>## # A tibble: 5 x 11
##   name           height  mass hair_color skin_color  eye_color   Age sex   gender
##   &lt;chr&gt;           &lt;int&gt; &lt;dbl&gt; &lt;fct&gt;      &lt;fct&gt;       &lt;fct&gt;     &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt; 
## 1 Luke Skywalker    172    77 blond      fair        blue       19   male  mascu~
## 2 C-3PO             167    75 &lt;NA&gt;       gold        yellow    112   none  mascu~
## 3 R2-D2              96    32 &lt;NA&gt;       white, blue red        33   none  mascu~
## 4 Darth Vader       202   136 none       white       yellow     41.9 male  mascu~
## 5 Leia Organa       150    49 brown      light       brown      19   fema~ femin~
## # ... with 2 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;</code></pre>
<p>Bevor wir einsteigen, schaut euch an, wie die einzelnen Variablen im Datensatz verteilt sind. Benutzt dazu den den <code>summary()</code> Befehl, was fällt euch auf ?</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="datenstruktur.html#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(starwars)</span></code></pre></div>
<pre><code>##      name               height           mass           hair_color   skin_color
##  Length:87          Min.   : 66.0   Min.   :  15.00   none   :37   fair   :17  
##  Class :character   1st Qu.:167.0   1st Qu.:  55.60   brown  :18   light  :11  
##  Mode  :character   Median :180.0   Median :  79.00   black  :13   dark   : 6  
##                     Mean   :174.4   Mean   :  97.31   white  : 4   green  : 6  
##                     3rd Qu.:191.0   3rd Qu.:  84.50   blond  : 3   grey   : 6  
##                     Max.   :264.0   Max.   :1358.00   (Other): 7   pale   : 5  
##                     NA&#39;s   :6       NA&#39;s   :28        NA&#39;s   : 5   (Other):36  
##    eye_color       Age                     sex           gender  
##  brown  :21   Min.   :  8.00   female        :16   feminine :17  
##  blue   :19   1st Qu.: 35.00   hermaphroditic: 1   masculine:66  
##  yellow :11   Median : 52.00   male          :60   NA&#39;s     : 4  
##  black  :10   Mean   : 87.57   none          : 6                 
##  orange : 8   3rd Qu.: 72.00   NA&#39;s          : 4                 
##  red    : 5   Max.   :896.00                                     
##  (Other):13   NA&#39;s   :44                                         
##   homeworld           species         
##  Length:87          Length:87         
##  Class :character   Class :character  
##  Mode  :character   Mode  :character  
##                                       
##                                       
##                                       
## </code></pre>
</div>
<div id="dplyr-die-wichtigsten-befehle" class="section level2" number="3.12">
<h2><span class="header-section-number">3.12</span> Dplyr: Die wichtigsten Befehle</h2>
<ul>
<li><p>Filtern von Beobachtungen nach Wert (<a href="https://rdrr.io/r/stats/filter.html"><code>filter()</code></a>).</p></li>
<li><p>Reihen neu Sortieren (<code>arrange()</code>).</p></li>
<li><p>Auswahl von Variablen nach Name (<code>select()</code>).</p></li>
<li><p>Erstellen von neuen Variablen aus bereits existierenden (<code>mutate()</code>).</p></li>
<li><p>Viele Werte zu einem einzelnen Wert zusammenfassen (<code>summarise()</code>).</p></li>
</ul>
<p>Der vielleicht wichtigste Befehl ist der <code>group_by()</code> Befehl, mit dem Ihr die oben genannten Befehle auf einzelne Gruppen innerhalb eines Datensatzes anwenden könnt.</p>
<p>Diese 6 sogennaten “Verben” bilden die Grundlage für tidyverse.Damit ist es möglichmehrere einfache Schritte miteinander zu verketten, um ein komplexes Ergebnis zu erzielen. Alles Befehle funktionieren auf die gleiche Art und Weise:</p>
<ol style="list-style-type: decimal">
<li><p>Das erste Argument ist ein Dataframe.</p></li>
<li><p>Die nachfolgenden Argumente beschreiben, was mit dem Dataframe geschehen soll, wobei die Variablennamen (ohne Anführungszeichen) verwendet werden.</p></li>
<li><p>Das Ergebnis ist ein neuer Dataframe</p></li>
</ol>
<p>Hier ein Beispiel, zum <code>filter()</code> Befehl, dazu müsst ihr auch wissen, wie Ihr die gewünschten Beobachtungen mit Hilfe der Vergleichsoperatoren auswählen können. R bietet euch hier die Standardoperatoren:</p>
<ol style="list-style-type: decimal">
<li><p><code>&gt;</code> (größer)</p></li>
<li><p><code>&gt;=</code> (größer gleich)</p></li>
<li><p><code>&lt;</code> (kleiner)</p></li>
<li><p><code>&lt;=</code> (kleiner gleich)</p></li>
<li><p><code>!=</code> (nicht gleich)</p></li>
<li><p><code>==</code>(gleich)</p></li>
</ol>
<p>Anmerkung: Es gibt auch noch logische Operatoren, also “und,” “oder” etc. Diese Besprechen wir nicht im Detail, da das sonst zu viel würde. Die Logik der Anwendungen ist aber genau gleich wie bei den Vergleichsoperatoren, hier nur der Vollstädigkeit halber eine übersicht über diese Operatoren:<br />
</p>
<div class="figure">
<img src="https://d33wubrfki0l68.cloudfront.net/01f4b6d39d2be8269740a3ad7946faa79f7243cf/8369a/diagrams/transform-logical.png" title="Logische Operatoren und Ihre Aussage" width="800" alt="" />
<p class="caption">Logische Operatoren in R</p>
</div>
<p>Beispiel</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="datenstruktur.html#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wenn wir zum Beispiel wissen wollen, wer die größten und schwersten Charaktere aus Starwars sind, dann könnten wir dies so machen:</span></span>
<span id="cb91-2"><a href="datenstruktur.html#cb91-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-3"><a href="datenstruktur.html#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(starwars, height <span class="sc">&gt;</span> <span class="dv">190</span>, mass <span class="sc">&gt;</span> <span class="dv">90</span>)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 11
##   name            height  mass hair_color skin_color eye_color   Age sex   gender
##   &lt;chr&gt;            &lt;int&gt; &lt;dbl&gt; &lt;fct&gt;      &lt;fct&gt;      &lt;fct&gt;     &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt; 
## 1 Darth Vader        202   136 none       white      yellow     41.9 male  mascu~
## 2 Chewbacca          228   112 brown      unknown    blue      200   male  mascu~
## 3 IG-88              200   140 none       metal      red        15   none  mascu~
## 4 Dexter Jettster    198   102 none       brown      yellow     NA   male  mascu~
## 5 Grievous           216   159 none       brown, wh~ green, y~  NA   male  mascu~
## 6 Tarfful            234   136 brown      brown      blue       NA   male  mascu~
## # ... with 2 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="datenstruktur.html#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wir filtern hier alle heraus, die größer sind als 190 und mehr als 90 Kilo wiegen</span></span></code></pre></div>
<p>Wenn man mit Strings arbeitet sucht man häufig nach bestimmen <code>pattern</code> in den Strings, wie hier bei den Namen. Wollen wir nun alle Skywalkers filtern, müssen wir die <code>grepl()</code> Funktion aus R nutzen. Diese prüft, ob eine Zeichenfolge vorhanden ist oder nicht und gibt dann entsprechend TRUE oder FALSE aus, also perfekt für <code>filter()</code> . Bei Strings die nur aus einem Wort bestehen, funktioniert aber auch <code>filter(starwars, species=="human").</code></p>
<p>Beispiel:</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="datenstruktur.html#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(starwars, species <span class="sc">==</span> <span class="st">&quot;Human&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 35 x 11
##    name        height  mass hair_color  skin_color eye_color   Age sex   gender 
##    &lt;chr&gt;        &lt;int&gt; &lt;dbl&gt; &lt;fct&gt;       &lt;fct&gt;      &lt;fct&gt;     &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;  
##  1 Luke Skywa~    172    77 blond       fair       blue       19   male  mascul~
##  2 Darth Vader    202   136 none        white      yellow     41.9 male  mascul~
##  3 Leia Organa    150    49 brown       light      brown      19   fema~ femini~
##  4 Owen Lars      178   120 brown, grey light      blue       52   male  mascul~
##  5 Beru White~    165    75 brown       light      blue       47   fema~ femini~
##  6 Biggs Dark~    183    84 black       light      brown      24   male  mascul~
##  7 Obi-Wan Ke~    182    77 auburn, wh~ fair       blue-gray  57   male  mascul~
##  8 Anakin Sky~    188    84 blond       fair       blue       41.9 male  mascul~
##  9 Wilhuff Ta~    180    NA auburn, gr~ fair       blue       64   male  mascul~
## 10 Han Solo       180    80 brown       fair       brown      29   male  mascul~
## # ... with 25 more rows, and 2 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="datenstruktur.html#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Alle Helden, mit dem Nachnamen Skywalker</span></span>
<span id="cb96-2"><a href="datenstruktur.html#cb96-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-3"><a href="datenstruktur.html#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(starwars, <span class="fu">grepl</span>(<span class="st">&quot;Skywalker&quot;</span>, name))</span></code></pre></div>
<pre><code>## # A tibble: 3 x 11
##   name         height  mass hair_color skin_color eye_color   Age sex    gender 
##   &lt;chr&gt;         &lt;int&gt; &lt;dbl&gt; &lt;fct&gt;      &lt;fct&gt;      &lt;fct&gt;     &lt;dbl&gt; &lt;fct&gt;  &lt;fct&gt;  
## 1 Luke Skywal~    172    77 blond      fair       blue       19   male   mascul~
## 2 Anakin Skyw~    188    84 blond      fair       blue       41.9 male   mascul~
## 3 Shmi Skywal~    163    NA black      fair       brown      72   female femini~
## # ... with 2 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="datenstruktur.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Es wird im Datensatz starwars nach dem String &quot;Skywalker&quot; in der Spalte name gesucht. </span></span>
<span id="cb98-2"><a href="datenstruktur.html#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Das Ergebnis sieht dann so aus: </span></span></code></pre></div>
<p>Wichtig ist natürlich für uns auch der Umgang mit Faktoren. Glücklicherweise ist das viel einfacher als mit Strings:</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="datenstruktur.html#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wenn wir nun nach einem bestimmten Faktor-Level Filtern wollen geht das genauso wie mit numerischen Werten:</span></span>
<span id="cb99-2"><a href="datenstruktur.html#cb99-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-3"><a href="datenstruktur.html#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(starwars, sex <span class="sc">==</span> <span class="st">&quot;male&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 60 x 11
##    name        height  mass hair_color  skin_color eye_color   Age sex   gender 
##    &lt;chr&gt;        &lt;int&gt; &lt;dbl&gt; &lt;fct&gt;       &lt;fct&gt;      &lt;fct&gt;     &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;  
##  1 Luke Skywa~    172    77 blond       fair       blue       19   male  mascul~
##  2 Darth Vader    202   136 none        white      yellow     41.9 male  mascul~
##  3 Owen Lars      178   120 brown, grey light      blue       52   male  mascul~
##  4 Biggs Dark~    183    84 black       light      brown      24   male  mascul~
##  5 Obi-Wan Ke~    182    77 auburn, wh~ fair       blue-gray  57   male  mascul~
##  6 Anakin Sky~    188    84 blond       fair       blue       41.9 male  mascul~
##  7 Wilhuff Ta~    180    NA auburn, gr~ fair       blue       64   male  mascul~
##  8 Chewbacca      228   112 brown       unknown    blue      200   male  mascul~
##  9 Han Solo       180    80 brown       fair       brown      29   male  mascul~
## 10 Greedo         173    74 &lt;NA&gt;        green      black      44   male  mascul~
## # ... with 50 more rows, and 2 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;</code></pre>
</div>
<div id="übung-1" class="section level2" number="3.13">
<h2><span class="header-section-number">3.13</span> Übung 1</h2>
<p>Filtert nun selbst den Datensatz nach bestimmten Kriterien</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="datenstruktur.html#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1.) Filtert alle Helden, die Älter sind als 20 und größer als 160 sind</span></span>
<span id="cb101-2"><a href="datenstruktur.html#cb101-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-3"><a href="datenstruktur.html#cb101-3" aria-hidden="true" tabindex="-1"></a>fat_starwars <span class="ot">&lt;-</span> <span class="fu">filter</span>(starwars, Age <span class="sc">&gt;</span> <span class="dv">20</span>, height <span class="sc">&gt;</span> <span class="dv">160</span>)</span>
<span id="cb101-4"><a href="datenstruktur.html#cb101-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-5"><a href="datenstruktur.html#cb101-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 2.) Filtert alle Helden, die Blaue Augen haben und männlich sind</span></span>
<span id="cb101-6"><a href="datenstruktur.html#cb101-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-7"><a href="datenstruktur.html#cb101-7" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(starwars, eye_color <span class="sc">==</span> <span class="st">&quot;blue&quot;</span>, sex <span class="sc">==</span> <span class="st">&quot;male&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 12 x 11
##    name        height  mass hair_color  skin_color eye_color   Age sex   gender 
##    &lt;chr&gt;        &lt;int&gt; &lt;dbl&gt; &lt;fct&gt;       &lt;fct&gt;      &lt;fct&gt;     &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;  
##  1 Luke Skywa~    172    77 blond       fair       blue       19   male  mascul~
##  2 Owen Lars      178   120 brown, grey light      blue       52   male  mascul~
##  3 Anakin Sky~    188    84 blond       fair       blue       41.9 male  mascul~
##  4 Wilhuff Ta~    180    NA auburn, gr~ fair       blue       64   male  mascul~
##  5 Chewbacca      228   112 brown       unknown    blue      200   male  mascul~
##  6 Jek Tono P~    180   110 brown       fair       blue       NA   male  mascul~
##  7 Lobot          175    79 none        light      blue       37   male  mascul~
##  8 Qui-Gon Ji~    193    89 brown       fair       blue       92   male  mascul~
##  9 Finis Valo~    170    NA blond       fair       blue       91   male  mascul~
## 10 Mas Amedda     196    NA none        blue       blue       NA   male  mascul~
## 11 Cliegg Lars    183    NA brown       fair       blue       82   male  mascul~
## 12 Tarfful        234   136 brown       brown      blue       NA   male  mascul~
## # ... with 2 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="datenstruktur.html#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3.) Filtert alle, die zur Spezies Droid gehören</span></span>
<span id="cb103-2"><a href="datenstruktur.html#cb103-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-3"><a href="datenstruktur.html#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(starwars, species<span class="sc">==</span><span class="st">&quot;Droid&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 11
##   name   height  mass hair_color skin_color  eye_color   Age sex   gender   
##   &lt;chr&gt;   &lt;int&gt; &lt;dbl&gt; &lt;fct&gt;      &lt;fct&gt;       &lt;fct&gt;     &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;    
## 1 C-3PO     167    75 &lt;NA&gt;       gold        yellow      112 none  masculine
## 2 R2-D2      96    32 &lt;NA&gt;       white, blue red          33 none  masculine
## 3 R5-D4      97    32 &lt;NA&gt;       white, red  red          NA none  masculine
## 4 IG-88     200   140 none       metal       red          15 none  masculine
## 5 R4-P17     96    NA none       silver, red red, blue    NA none  feminine 
## 6 BB8        NA    NA none       none        black        NA none  masculine
## # ... with 2 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;</code></pre>
</div>
<div id="dplyr-der-piping-operator" class="section level2" number="3.14">
<h2><span class="header-section-number">3.14</span> Dplyr: Der Piping Operator</h2>
<p>Jetzt wisst ihr, wie man Daten filtert. Das ist aber nur eine der Basisfunktionen von dplyr. Die vielleicht wichtigste Funktion der sogenannte “piping operator” <code>%&gt;%</code> Mit diesem könnt ihr die Befehle kombinieren, oder auch “verketten” um die Datensätze nach euren Wünschen umzugestalten. Das funktioniert auch immer nach den oben genannten Prinzipien:</p>
<ol style="list-style-type: decimal">
<li><p>Das erste Argument ist ein Dataframe.</p></li>
<li><p>Die nachfolgenden Argumente beschreiben, was mit dem Dataframe geschehen soll, wobei die Variablennamen (ohne Anführungszeichen) verwendet werden.</p></li>
<li><p>Das Ergebnis ist ein neuer Dataframe</p></li>
</ol>
<p>Wir werden hier erstmal nur die basis dplyr-Funktionen besprechen. Aber auch alle anderen Befehle lassen sich in eine “Pipeline” integrieren. Hier mal ein sehr fortgeschrittenes Beispiel, wie das aussehen kann:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="datenstruktur.html#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># df_clean %&gt;% group_by(N,K,Retrievals) %&gt;%  </span></span>
<span id="cb105-2"><a href="datenstruktur.html#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarise(corA = cor(mu_est_a, mu_real_a),</span></span>
<span id="cb105-3"><a href="datenstruktur.html#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="co">#             corC = cor(mu_est_c, mu_real_c)) %&gt;%</span></span>
<span id="cb105-4"><a href="datenstruktur.html#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(z_a = fisherz(corA), z_c = fisherz(corC)) %&gt;% </span></span>
<span id="cb105-5"><a href="datenstruktur.html#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Retrievals== 100) %&gt;%</span></span>
<span id="cb105-6"><a href="datenstruktur.html#cb105-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(N,K) %&gt;%  </span></span>
<span id="cb105-7"><a href="datenstruktur.html#cb105-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarise(mean_a_100 = mean(z_a),</span></span>
<span id="cb105-8"><a href="datenstruktur.html#cb105-8" aria-hidden="true" tabindex="-1"></a><span class="co">#             mean_c_100 = mean(z_c),</span></span>
<span id="cb105-9"><a href="datenstruktur.html#cb105-9" aria-hidden="true" tabindex="-1"></a><span class="co">#             range_cor = range(mean_a_100),</span></span>
<span id="cb105-10"><a href="datenstruktur.html#cb105-10" aria-hidden="true" tabindex="-1"></a><span class="co">#             range_cor = range(mean_a_100)) %&gt;%</span></span>
<span id="cb105-11"><a href="datenstruktur.html#cb105-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(meanCorA_100 = fisherz2r(mean_a_100),</span></span>
<span id="cb105-12"><a href="datenstruktur.html#cb105-12" aria-hidden="true" tabindex="-1"></a><span class="co">#          meanCorC_100 = fisherz2r(mean_c_100)) %&gt;%</span></span>
<span id="cb105-13"><a href="datenstruktur.html#cb105-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-c(mean_a_100, mean_c_100))</span></span></code></pre></div>
</div>
<div id="beispiel" class="section level2" number="3.15">
<h2><span class="header-section-number">3.15</span> Beispiel</h2>
<p>Stellt euch vor, ihr wollte gerne den Mittelwert des Alters der Helden aus dem Starwars Datensatz berechnen, und das für unterschiedliche Heimatwelten und Spezies:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="datenstruktur.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dazu benutzen wir den Piping Operator %&gt;%, um die Befehle zu verketten:</span></span>
<span id="cb106-2"><a href="datenstruktur.html#cb106-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-3"><a href="datenstruktur.html#cb106-3" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span> </span>
<span id="cb106-4"><a href="datenstruktur.html#cb106-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species, homeworld) <span class="sc">%&gt;%</span> </span>
<span id="cb106-5"><a href="datenstruktur.html#cb106-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_Age=</span><span class="fu">mean</span>(Age))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;species&#39;. You can override using the `.groups` argument.</code></pre>
<pre><code>## # A tibble: 58 x 3
## # Groups:   species [38]
##    species  homeworld   mean_Age
##    &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;
##  1 Aleena   Aleen Minor       NA
##  2 Besalisk Ojom              NA
##  3 Cerean   Cerea             92
##  4 Chagrian Champala          NA
##  5 Clawdite Zolan             NA
##  6 Droid    Naboo             33
##  7 Droid    Tatooine          NA
##  8 Droid    &lt;NA&gt;              NA
##  9 Dug      Malastare         NA
## 10 Ewok     Endor              8
## # ... with 48 more rows</code></pre>
<p>Wir schreiben hier im Prinzip:</p>
<ol style="list-style-type: decimal">
<li>Nehme den Datensatz starwars (1. Zuerst der Dataframe):</li>
</ol>
<!-- -->
<pre><code>`starwars %&gt;%`</code></pre>
<ol start="2" style="list-style-type: decimal">
<li><p>Gruppiere diesen nach Spezies und Heimatwelt (1. Verarbeitungsschritt):</p>
<p><code>`group_by(species, homeworld) %&gt;%`</code></p></li>
<li><p>Berechne dann für jede dieser Gruppen den Mittelwert für die Variable “Age” (2. Schritt):</p></li>
</ol>
<!-- -->
<pre><code>`summarise(meanAge=mean(Age)`</code></pre>
<p>Da wir nun den Piping Operator benutzen der vom Dataframe starwars ausgeht, müssen wir auch nicht mehr bei jedem Befehl den Datensatz angeben, es reicht dies am Anfang der “Pipeline” zu tun.</p>
<p>Problem: Wir haben noch viele fehlende Beobachtungen. Diese müssen wir zunächst entfehrnen. Auch das können wir nun innerhalb der “Pipeline” tun. Dazu bietet R den Befehl <code>drop_na()</code> an. Dieser entfehrnt alle fehlenden Werte eines Datensatzes.</p>
<p>Wir müssen diesen Befehl nun einfach an eine Stelle in der Pipe einfügen, an der es Sinn macht, die Fehlenden Werte zu entfehrnen:</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="datenstruktur.html#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wo könnte das hier sein ? </span></span>
<span id="cb111-2"><a href="datenstruktur.html#cb111-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-3"><a href="datenstruktur.html#cb111-3" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span></span>
<span id="cb111-4"><a href="datenstruktur.html#cb111-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species, homeworld) <span class="sc">%&gt;%</span> </span>
<span id="cb111-5"><a href="datenstruktur.html#cb111-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_Age=</span><span class="fu">mean</span>(Age))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;species&#39;. You can override using the `.groups` argument.</code></pre>
<pre><code>## # A tibble: 21 x 3
## # Groups:   species [11]
##    species homeworld    mean_Age
##    &lt;chr&gt;   &lt;chr&gt;           &lt;dbl&gt;
##  1 Cerean  Cerea            92  
##  2 Ewok    Endor             8  
##  3 Gungan  Naboo            52  
##  4 Human   Alderaan         19  
##  5 Human   Bespin           37  
##  6 Human   Concord Dawn     66  
##  7 Human   Corellia         25  
##  8 Human   Haruun Kal       72  
##  9 Human   Kamino           31.5
## 10 Human   Naboo            64  
## # ... with 11 more rows</code></pre>
<p>Nun haben wir nach verschiedenen Gruppen die Altersmittelwerte, bereinigt von den fehlenden Werten. Und das mit nur 2 Zeilen Code :)</p>
</div>
<div id="übung-2" class="section level2" number="3.16">
<h2><span class="header-section-number">3.16</span> Übung 2</h2>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="datenstruktur.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1.) Gruppiert die Daten nach der Haarfarbe und berechnet für alle vollständigen Werte den Mittelwert und die Standardabweichung für die Größe und das Gewicht. Benutzt dafür wie im vorigen Beispiel die summarise() Funktion. Mit dieser könnt ihr auch mehrere Variablen berechnen. Bindet auch den drop_na() ein. Am Ende sollte es keine NA-Werte mehr in der Ausgabe geben. </span></span>
<span id="cb114-2"><a href="datenstruktur.html#cb114-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-3"><a href="datenstruktur.html#cb114-3" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(hair_color) <span class="sc">%&gt;%</span></span>
<span id="cb114-4"><a href="datenstruktur.html#cb114-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_Height =</span> <span class="fu">mean</span>(height),</span>
<span id="cb114-5"><a href="datenstruktur.html#cb114-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd_Height=</span> <span class="fu">sd</span>(height),</span>
<span id="cb114-6"><a href="datenstruktur.html#cb114-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_Mass =</span> <span class="fu">mean</span>(mass),</span>
<span id="cb114-7"><a href="datenstruktur.html#cb114-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd_Mass =</span> <span class="fu">sd</span>(mass)) </span></code></pre></div>
<pre><code>## # A tibble: 8 x 5
##   hair_color    mean_Height sd_Height mean_Mass sd_Mass
##   &lt;fct&gt;               &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
## 1 auburn, white        182      NA         77     NA   
## 2 black                177       7.46      71.1   14.2 
## 3 blond                180      11.3       80.5    4.95
## 4 brown                164.     41.6       65.4   29.9 
## 5 brown, grey          178      NA        120     NA   
## 6 grey                 170      NA         75     NA   
## 7 none                 186.      9.50      86.2   24.3 
## 8 white                196.      3.54      81      1.41</code></pre>
</div>
<div id="dplyr-neue-variablen-mit-mutate-berechnen" class="section level2" number="3.17">
<h2><span class="header-section-number">3.17</span> Dplyr : Neue Variablen mit <code>mutate()</code> berechnen</h2>
<p>Der letzte wichtige Befehl in dplyr ist <code>mutate()</code> bzw. <code>across()</code>. Letztes mal haben wir in dem Beispiel der Matrix zwei Variablen miteinander kombiniert und daraus einen neue berechnet (Größe*5). Mit <code>mutate()</code> können wir eine Variable und mit <code>across()</code> gleich mehrere Variablen umformen, oder neu berechnen. Hier möchte ich es am Beispiel einer z-Tranformation erläutern. Diese werden wir mit dem Befehl <code>scale()</code> tun, der standardmäßig in R vorhanden ist.</p>
</div>
<div id="beispiel-1" class="section level2" number="3.18">
<h2><span class="header-section-number">3.18</span> Beispiel</h2>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="datenstruktur.html#cb116-1" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span> </span>
<span id="cb116-2"><a href="datenstruktur.html#cb116-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(height,mass) <span class="sc">%&gt;%</span> </span>
<span id="cb116-3"><a href="datenstruktur.html#cb116-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">z_height =</span> <span class="fu">scale</span>(height),</span>
<span id="cb116-4"><a href="datenstruktur.html#cb116-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_mass =</span> <span class="fu">scale</span>(mass)) <span class="sc">%&gt;%</span> </span>
<span id="cb116-5"><a href="datenstruktur.html#cb116-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span></code></pre></div>
<pre><code>## # A tibble: 59 x 4
##    height  mass z_height[,1] z_mass[,1]
##     &lt;int&gt; &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;
##  1    172    77      -0.0678    -0.120 
##  2    167    75      -0.212     -0.132 
##  3     96    32      -2.25      -0.385 
##  4    202   136       0.795      0.228 
##  5    150    49      -0.701     -0.285 
##  6    178   120       0.105      0.134 
##  7    165    75      -0.269     -0.132 
##  8     97    32      -2.22      -0.385 
##  9    183    84       0.249     -0.0786
## 10    182    77       0.220     -0.120 
## # ... with 49 more rows</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="datenstruktur.html#cb118-1" aria-hidden="true" tabindex="-1"></a> starwars <span class="sc">%&gt;%</span> <span class="fu">select</span>(height,mass) <span class="sc">%&gt;%</span> </span>
<span id="cb118-2"><a href="datenstruktur.html#cb118-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(height,mass), <span class="fu">list</span>(<span class="at">z=</span>scale))) <span class="sc">%&gt;%</span></span>
<span id="cb118-3"><a href="datenstruktur.html#cb118-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span></code></pre></div>
<pre><code>## # A tibble: 59 x 4
##    height  mass height_z[,1] mass_z[,1]
##     &lt;int&gt; &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;
##  1    172    77      -0.0678    -0.120 
##  2    167    75      -0.212     -0.132 
##  3     96    32      -2.25      -0.385 
##  4    202   136       0.795      0.228 
##  5    150    49      -0.701     -0.285 
##  6    178   120       0.105      0.134 
##  7    165    75      -0.269     -0.132 
##  8     97    32      -2.22      -0.385 
##  9    183    84       0.249     -0.0786
## 10    182    77       0.220     -0.120 
## # ... with 49 more rows</code></pre>
<p>In diesem Beispiel haben wir zunächste nur <code>height</code> und <code>mass</code> mit dem <code>select()</code> Befehl ausgewählt, daher werden auch nur diese beiden Spalten am Ende der Pipline im Datensatz angezeigt. Dies kann hilfreich sein, wenn man einen Datensatz mit sehr vielen Variablen analysieren muss, von denen nur einige wenige interessant sind. Dies ist meiner Erfahrung nach zum Beispiel bei Fragebögen der Fall, die unterschiedliche Facetten erfassen.</p>
<p>Der nächste Befehl <code>mutate()</code> besteht immer aus einer Operation, die mit einer Spalte im Datensatz durchgeführt wird. Im Beispiel oben fügen wir also die Spalten <code>z_height</code> und <code>z_mass</code> hinzu, die sich jeweils aus <code>scale(SPALTENNAME)</code> berechnen und die z-Werte der jeweiligen Variablen berechnen.</p>
<p>Wir können auch anstatt die Variablen einzeln umzurechnen, den Befehl <code>scale()</code> direkt auf mehrere Spalten anwenden. Dazu können wir den <code>across()</code> Befehl verwenden. Hier müssen wir innerhalb von <code>mutate()</code> einfach mit <code>across(c(SPALTE1, SPALTE2))</code> einen Vektor der gewünschten Spalten übergeben und dann die Funktion(en), welche auf die Spalten angewand werden soll. Dies muss dann so definiert werden:</p>
<p><code>mutate(across(c(height,mass), list(z=scale)))</code></p>
<p>Diese Schreibweise hat den Vorteil das ihr</p>
<ol style="list-style-type: decimal">
<li><p>In der <code>list()</code> mehrere Befehle übergeben könnt</p></li>
<li><p>Die Originalspalten beibehalten werden</p></li>
<li><p>Ihr den neuen Spalten direkt einen Suffix geben könnt.<br />
Dieser wird automatisch als “_suffix” an die neue Variable angehängt.</p>
<p><code>mutate(across(c(height,mass), list(z=scale)))</code> würde also zusätzliche zu Spalte1 und Spalte2 noch Spalte1_z und Spalte2_z, die den z-Wert der jeweiligen Variablen</p></li>
</ol>
</div>
<div id="aufgabe-bis-zum-nächsten-mal" class="section level2" number="3.19">
<h2><span class="header-section-number">3.19</span> Aufgabe bis zum nächsten Mal</h2>
<p>Übersetzt diese Anweisungen in dplyr-Sprache:</p>
<ol style="list-style-type: decimal">
<li>Dataframe starwars</li>
<li>Gruppiert diesen nach Spezies</li>
<li>Entfehrnt alle fehlenden Werte</li>
<li>Fasst die Variablen Age und Height zu nur einem Mittelwert zusammen</li>
<li>z-Transformiert die Mittelwerte beider Spalten.</li>
</ol>
<p>Befehle die Ihr dazu braucht:</p>
<p><code>drop_na(), across()</code> ,<code>scale(), mutate(), group_by(), summarise(), mean()</code></p>
<p>Wenn ihr es Richtig gemacht habt, sollte der Datensatz am Ende so aussehen:</p>
<p><img src="Merged_Data.png" /></p>
<p><em>Zusatzaufgabe:</em></p>
<p><em>Ihr könnt den <code>summarise()</code> Befehl auch mit <code>across()</code> umsetzen und automatisch einen Suffix für die zusammengefassten Variablen erstellen, hierdurch spart man sich einige Tipparbeit. Das Ergebnis ist das gleiche, nur mit unterschiedlichen Spaltenamen für die “mean” Variablen.</em></p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="datenstruktur.html#cb120-1" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(species) <span class="sc">%&gt;%</span></span>
<span id="cb120-2"><a href="datenstruktur.html#cb120-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span></span>
<span id="cb120-3"><a href="datenstruktur.html#cb120-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_Age =</span> <span class="fu">mean</span>(Age),</span>
<span id="cb120-4"><a href="datenstruktur.html#cb120-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_Height =</span> <span class="fu">mean</span>(height)) <span class="sc">%&gt;%</span></span>
<span id="cb120-5"><a href="datenstruktur.html#cb120-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mean_Age_z =</span> <span class="fu">scale</span>(mean_Age),</span>
<span id="cb120-6"><a href="datenstruktur.html#cb120-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean_Height_z =</span> <span class="fu">scale</span>(mean_Height))</span></code></pre></div>
<pre><code>## # A tibble: 11 x 5
##    species      mean_Age mean_Height mean_Age_z[,1] mean_Height_z[,1]
##    &lt;chr&gt;           &lt;dbl&gt;       &lt;dbl&gt;          &lt;dbl&gt;             &lt;dbl&gt;
##  1 Cerean           92           198          0.622            0.561 
##  2 Ewok              8            88         -1.03            -2.66  
##  3 Gungan           52           196         -0.166            0.503 
##  4 Human            45.5         178         -0.293           -0.0239
##  5 Kel Dor          22           188         -0.757            0.269 
##  6 Mirialan         49           168         -0.225           -0.317 
##  7 Mon Calamari     41           180         -0.382            0.0346
##  8 Trandoshan       53           190         -0.146            0.327 
##  9 Twi&#39;lek          48           178         -0.245           -0.0239
## 10 Wookiee         200           228          2.75             1.44  
## 11 Zabrak           54           175         -0.126           -0.112</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="datenstruktur.html#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mit across()</span></span>
<span id="cb122-2"><a href="datenstruktur.html#cb122-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-3"><a href="datenstruktur.html#cb122-3" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(species) <span class="sc">%&gt;%</span></span>
<span id="cb122-4"><a href="datenstruktur.html#cb122-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span></span>
<span id="cb122-5"><a href="datenstruktur.html#cb122-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">c</span>(Age, height), <span class="fu">list</span>(<span class="at">mean=</span> mean))) <span class="sc">%&gt;%</span></span>
<span id="cb122-6"><a href="datenstruktur.html#cb122-6" aria-hidden="true" tabindex="-1"></a>           <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(Age_mean, height_mean), <span class="fu">list</span>(<span class="at">z=</span>scale)))</span></code></pre></div>
<pre><code>## # A tibble: 11 x 5
##    species      Age_mean height_mean Age_mean_z[,1] height_mean_z[,1]
##    &lt;chr&gt;           &lt;dbl&gt;       &lt;dbl&gt;          &lt;dbl&gt;             &lt;dbl&gt;
##  1 Cerean           92           198          0.622            0.561 
##  2 Ewok              8            88         -1.03            -2.66  
##  3 Gungan           52           196         -0.166            0.503 
##  4 Human            45.5         178         -0.293           -0.0239
##  5 Kel Dor          22           188         -0.757            0.269 
##  6 Mirialan         49           168         -0.225           -0.317 
##  7 Mon Calamari     41           180         -0.382            0.0346
##  8 Trandoshan       53           190         -0.146            0.327 
##  9 Twi&#39;lek          48           178         -0.245           -0.0239
## 10 Wookiee         200           228          2.75             1.44  
## 11 Zabrak           54           175         -0.126           -0.112</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="einführung.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="deskreptive-statistik.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
